
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://elblo.github.io/prog/cleancode/refactoring.html">
      
      
        <link rel="prev" href="../index.html">
      
      
      
      <link rel="icon" href="../imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Refactorización - Programación</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#refactorizacion" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Programación" class="md-header__button md-logo" aria-label="Programación" data-md-component="logo">
      
  <img src="../imagenes/logoies.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Programación
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Refactorización
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="Teal"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Programación" class="md-nav__button md-logo" aria-label="Programación" data-md-component="logo">
      
  <img src="../imagenes/logoies.png" alt="logo">

    </a>
    Programación
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Clean Code
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Clean Code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Refactorización
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="refactoring.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Refactorización
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduccion" class="md-nav__link">
    <span class="md-ellipsis">
      Introducción
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renombrar-variables-y-metodos" class="md-nav__link">
    <span class="md-ellipsis">
      Renombrar variables y métodos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encapsulacion" class="md-nav__link">
    <span class="md-ellipsis">
      Encapsulación
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extraer-constantes" class="md-nav__link">
    <span class="md-ellipsis">
      Extraer constantes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extraer-metodos" class="md-nav__link">
    <span class="md-ellipsis">
      Extraer métodos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducir-metodos" class="md-nav__link">
    <span class="md-ellipsis">
      Introducir métodos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convertir-parametros-en-objetos" class="md-nav__link">
    <span class="md-ellipsis">
      Convertir parámetros en objetos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-variable-temporal-con-consulta" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar variable temporal con consulta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducir-variable-explicativa" class="md-nav__link">
    <span class="md-ellipsis">
      Introducir variable explicativa
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#separar-variable-temporal" class="md-nav__link">
    <span class="md-ellipsis">
      Separar variable temporal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eliminar-asignaciones-a-parametros" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminar asignaciones a parámetros
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-metodo-con-un-objeto" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar método con un objeto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descomponer-condicional" class="md-nav__link">
    <span class="md-ellipsis">
      Descomponer condicional
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consolidar-expresion-condicional" class="md-nav__link">
    <span class="md-ellipsis">
      Consolidar expresión condicional
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consolidar-fragmentos-de-condicional-duplicados" class="md-nav__link">
    <span class="md-ellipsis">
      Consolidar fragmentos de condicional duplicados
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eliminar-bandera-de-control" class="md-nav__link">
    <span class="md-ellipsis">
      Eliminar bandera de control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-condicionales-anidados-con-clausulas-guard" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar condicionales anidados con claúsulas guard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-condicional-con-polimorfismo" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar condicional con polimorfismo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducir-objeto-nulo" class="md-nav__link">
    <span class="md-ellipsis">
      Introducir objeto nulo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#separar-consulta-de-modificacion" class="md-nav__link">
    <span class="md-ellipsis">
      Separar consulta de modificación
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parametrizar-metodo" class="md-nav__link">
    <span class="md-ellipsis">
      Parametrizar método
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-parametro-con-metodo-explicito" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar parámetro con método explícito
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sustituir-algoritmo" class="md-nav__link">
    <span class="md-ellipsis">
      Sustituir algoritmo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extraer-clase" class="md-nav__link">
    <span class="md-ellipsis">
      Extraer clase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clase-en-linea" class="md-nav__link">
    <span class="md-ellipsis">
      Clase en línea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ocultar-delegar" class="md-nav__link">
    <span class="md-ellipsis">
      Ocultar Delegar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducir-metodo-externo" class="md-nav__link">
    <span class="md-ellipsis">
      Introducir método externo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introducir-extension-local" class="md-nav__link">
    <span class="md-ellipsis">
      Introducir extensión local
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-un-dato-con-un-objeto" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar un dato con un objeto
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encapsular-coleccion" class="md-nav__link">
    <span class="md-ellipsis">
      Encapsular colección
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pull-up" class="md-nav__link">
    <span class="md-ellipsis">
      Pull up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#push-down" class="md-nav__link">
    <span class="md-ellipsis">
      Push down
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reemplazar-array-con-objeto" class="md-nav__link">
    <span class="md-ellipsis">
      Reemplazar array con objeto
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="refactorizacion">Refactorización<a class="headerlink" href="#refactorizacion" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>Refactorizar es <strong>cambiar el código mejorando su estructura</strong> sin alterar su comportamiento.</p>
<blockquote>
<p>"Cualquiera puede escribir código que un ordenador pueda entender. Los buenos programadores son aquellos que escriben código que los humanos puedan entender." - Martin Fowler</p>
</blockquote>
<p>A continuación se presentan diferentes técnicas para refactorizar código. En cada apartado encontrarás el código original y el refactorizado. Es posible y recomendable aplicar varias de las técnicas a un mismo código.</p>
<h2 id="renombrar-variables-y-metodos">Renombrar variables y métodos<a class="headerlink" href="#renombrar-variables-y-metodos" title="Permanent link">&para;</a></h2>
<p>Cambiar nombres de variables y métodos por otros adecuados para su contexto aporta una mayor legibilidad del código y aclara su propósito.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>No queda claro qué hace el método o qué almacenan las variables.</li>
</ul>
<div class="highlight"><span class="filename">rename/Conversor.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Conversor</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">conv</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">92678.27f</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>Todos los IDEs modernos tienen herramientas de refactorización que es conveniente saber utilizar para evitar despistes al realizar cambios manuales. En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorizacón</summary>
<ul>
<li>Se define como constante <code>BTC_EUR_CHANGE_RATE</code>.</li>
<li>El método <code>conv</code> se renombra a <code>bitcoinsToEuros</code>.</li>
<li>La variable <code>c</code> se renombra a <code>bitcoins</code>.</li>
<li>La variable <code>x</code> se renombra a <code>euros</code>.</li>
</ul>
<div class="highlight"><span class="filename">rename/refactored/Conversor.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Conversor</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">BTC_EUR_CHANGE_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">92678.27f</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">convertBitcoinsToEuros</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">bitcoins</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="5 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">euros</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bitcoins</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">EUR_BTC_CHANGE_RATE</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">euros</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
</details>
<div class="admonition abstract">
<p class="admonition-title">Recomendación</p>
<p>Como norma general a la hora de nombrar se suele utilizar:</p>
<ul>
<li><strong>Sustantivos</strong> para <em>variables</em>. Ej: <code>price</code>.</li>
<li><strong>Verbos</strong> para <em>métodos</em>. Ej: <code>getPrice</code>.</li>
</ul>
</div>
<h2 id="encapsulacion">Encapsulación<a class="headerlink" href="#encapsulacion" title="Permanent link">&para;</a></h2>
<p>Ocultar propiedades y métodos que no se usen desde fuera haciéndolos privados mejora las operaciones de acceso sin exponer detalles internos de la propia clase.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<div class="highlight"><span class="filename">encapsulate/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">init</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Eugene Krabs&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar la variable y <code>Refactor &gt; Encapsulate Fields</code>.</p>
<details class="abstract">
<summary>Refactorizacón</summary>
<ul>
<li>Se definen como privados los atributos <code>name</code> e <code>id</code>.    </li>
<li>Se añaden sus getters y setters correspondientes.</li>
<li>Se define como privado el método <code>init</code> porque sólo se usa internamente.</li>
</ul>
<div class="highlight"><span class="filename">rename/refactored/Conversor.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">init</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">setName</span><span class="p">(</span><span class="s">&quot;Eugene Krabs&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="n">setId</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">(){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">){</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getId</span><span class="p">(){</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setId</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">){</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getId</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getName</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="extraer-constantes">Extraer constantes<a class="headerlink" href="#extraer-constantes" title="Permanent link">&para;</a></h2>
<p>Extraer valores literales a constantes para aclarar el propósito del valor, aumentar la legibilidad, facilitar su cambio o incluso facilitar el uso de valores complejos como PI.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<div class="highlight"><span class="filename">magicnumbers/PasswordGenerator.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PasswordGenerator</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Random</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;abcdefghijkmnopqrstuvwxyz23456789&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generatePassword</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&quot;Wrong password length: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span><span class="w">                </span><span class="n">password</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">characters</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="n">characters</span><span class="p">.</span><span class="na">length</span><span class="p">()));</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el valor literal y <code>Refactor &gt; Introduce Constant</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Crear constantes <code>MAX_PASSWORD_LENGTH</code> y <code>MIN_PASSWORD_LENGTH</code> para los valores literales 15 y 6.</li>
</ul>
<div class="highlight"><span class="filename">magicnumbers/refactored/PasswordGenerator.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PasswordGenerator</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MAX_PASSWORD_LENGTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">MIN_PASSWORD_LENGTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Random</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">();</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;abcdefghijkmnopqrstuvwxyz23456789&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generatePassword</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MIN_PASSWORD_LENGTH</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MAX_PASSWORD_LENGTH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos=" 9 "></span><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Exception</span><span class="p">(</span><span class="s">&quot;Wrong password length: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="linenos" data-linenos="14 "></span><span class="w">                </span><span class="n">password</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">characters</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="n">characters</span><span class="p">.</span><span class="na">length</span><span class="p">()));</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="extraer-metodos">Extraer métodos<a class="headerlink" href="#extraer-metodos" title="Permanent link">&para;</a></h2>
<p>Extraer el código de un método en tantos otros como sea necesario para que cada uno tenga un tamaño máximo de unas 5 líneas aumenta la legibilidad y reduce el código duplicado.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<div class="highlight"><span class="filename">extractmethod/UrlNormalizer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UrlNormalizer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="c1">// First we trim whitespaces</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">.</span><span class="na">trim</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="c1">// Remove special chars</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">specialRemoved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">length</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="w"> </span>
<span class="linenos" data-linenos="12 "></span><span class="w">                    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;?&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">                </span><span class="n">specialRemoved</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">specialRemoved</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="c1">// Replace white spaces with hyphens</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">spacesReplaced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">length</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="23 "></span><span class="w">                </span><span class="n">spacesReplaced</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">                </span><span class="n">spacesReplaced</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="26 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spacesReplaced</span><span class="p">;</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="c1">// lowercase everything</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">toLowerCase</span><span class="p">();</span>
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el código que nos interese extraer y <code>Refactor &gt; Extract Method</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se extrae a métodos independientes cada fragmento de código que resuelva una pequeña tarea.</li>
</ul>
<div class="highlight"><span class="filename">extractmethod/refactored/UrlNormalizer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UrlNormalizer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trimSpaces</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">removeSpecialChars</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replaceSpaces</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">toLowerCase</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">replaceSpaces</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">spacesReplaced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">length</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">                </span><span class="n">spacesReplaced</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">                </span><span class="n">spacesReplaced</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spacesReplaced</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">removeSpecialChars</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">specialRemoved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">length</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="w"> </span>
<span class="linenos" data-linenos="30 "></span><span class="w">                    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;?&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="31 "></span><span class="w">                </span><span class="n">specialRemoved</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="32 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">specialRemoved</span><span class="p">;</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">trimSpaces</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="39 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="40 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">.</span><span class="na">trim</span><span class="p">();</span>
<span class="linenos" data-linenos="41 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="linenos" data-linenos="42 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="43 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="introducir-metodos">Introducir métodos<a class="headerlink" href="#introducir-metodos" title="Permanent link">&para;</a></h2>
<p>Reintroducir el código de un método dentro del método que lo llama para simplificar el código al prescindir de métodos demasiado simples u obvios. Hace el código más legible, simplifica las clases y evita la proliferación excesiva de métodos.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<div class="highlight"><span class="filename">inlinemethod/UrlCleaner.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UrlCleaner</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">clean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trimSpaces</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">removeSpecialChars</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replaceSpaces</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">toLowerCase</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">replaceSpaces</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">&quot;[\\s]+&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">).</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">&quot;[\\s]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">removeSpecialChars</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">&quot;[\\.\\:\\,\\?\\!\\_\\;]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">trimSpaces</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">url</span><span class="p">.</span><span class="na">trim</span><span class="p">();</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se reducen todos los métodos a un único método.</li>
</ul>
<div class="highlight"><span class="filename">inlinemethod/refactored/UrlCleaner.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UrlCleaner</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">clean</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">title</span><span class="p">.</span><span class="na">trim</span><span class="p">()</span>
<span class="linenos" data-linenos="4 "></span><span class="w">                    </span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">&quot;[\\.\\:\\,\\?\\!\\_\\;]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Replaces special chars</span>
<span class="linenos" data-linenos="5 "></span><span class="w">                    </span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">&quot;[\\s]+&quot;</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w">                   </span><span class="c1">// Replace duplicated spaces</span>
<span class="linenos" data-linenos="6 "></span><span class="w">                    </span><span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">&quot;[\\s]&quot;</span><span class="p">,</span><span class="s">&quot;-&quot;</span><span class="p">);</span><span class="w">                   </span><span class="c1">// Replace spaces with hyphen</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="convertir-parametros-en-objetos">Convertir parámetros en objetos<a class="headerlink" href="#convertir-parametros-en-objetos" title="Permanent link">&para;</a></h2>
<p>Sustituir una lista de parámetros de un método por un objeto para simplificar su uso.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El método <code>addItem</code> tiene demasiados parámetros.</li>
</ul>
<div class="highlight"><span class="filename">parameterobject/Order.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Order</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Float</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addItem</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">productID</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">quantity</span><span class="p">,</span><span class="w"> </span><span class="n">Float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">Float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="n">items</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">productID</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">quantity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">quantity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">discount</span><span class="p">));</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateTotal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">Enumeration</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">keys</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">keys</span><span class="p">.</span><span class="na">hasMoreElements</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">keys</span><span class="p">.</span><span class="na">nextElement</span><span class="p">());</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">total</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método y <code>Refactor &gt; Introduce Parameter Object</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea una clase <code>OrderItem</code> que agrupa en sus atributos los antiguos parámetros.</li>
</ul>
<div class="highlight"><span class="filename">parameterobject/refactored/Order.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Order</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Float</span><span class="o">&gt;</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Hashtable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Float</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addItem</span><span class="w"> </span><span class="p">(</span><span class="n">OrderItem</span><span class="w"> </span><span class="n">orderItem</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="n">items</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">orderItem</span><span class="p">.</span><span class="na">getProductID</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">orderItem</span><span class="p">.</span><span class="na">getDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">orderItem</span><span class="p">.</span><span class="na">totalItem</span><span class="p">());</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateTotal</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">Enumeration</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">keys</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">while</span><span class="p">(</span><span class="n">keys</span><span class="p">.</span><span class="na">hasMoreElements</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">total</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">keys</span><span class="p">.</span><span class="na">nextElement</span><span class="p">());</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">total</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">parameterobject/refactored/OrderItem.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderItem</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">productID</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">OrderItem</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">productID</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">quantity</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">productID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">productID</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">quantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quantity</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">discount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">totalItem</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">quantity</span><span class="o">*</span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">quantity</span><span class="o">*</span><span class="n">price</span><span class="o">*</span><span class="n">discount</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="nf">getProductID</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">productID</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getDescription</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="p">}</span><span class="w">        </span>
<span class="linenos" data-linenos="27 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="reemplazar-variable-temporal-con-consulta">Reemplazar variable temporal con consulta<a class="headerlink" href="#reemplazar-variable-temporal-con-consulta" title="Permanent link">&para;</a></h2>
<p>Extraer el valor de una variable temporal a un método para reutilizar expresiones y producir un código más legible.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<div class="highlight"><span class="filename">replacetempwithquery/Student.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Student</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">hasGoodAttitude</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Student</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">hasGoodAttitude</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">hasGoodAttitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hasGoodAttitude</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateAverage</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">homework</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">exam</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">mark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">homework</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exam</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasGoodAttitude</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">mark</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">mark</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar la asignación y <code>Refactor &gt; Extract Method</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>En el método <code>mark</code> se extrae la operación que se le asignaba a la variable temporal.</li>
</ul>
<div class="highlight"><span class="filename">replacetempwithquery/refactored/Student.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StudentRefactored</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">hasGoodAttitude</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Student</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">hasGoodAttitude</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">hasGoodAttitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hasGoodAttitude</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateAverage</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">homework</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">exam</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasGoodAttitude</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">mark</span><span class="p">(</span><span class="n">homework</span><span class="p">,</span><span class="w"> </span><span class="n">exam</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">mark</span><span class="p">(</span><span class="n">homework</span><span class="p">,</span><span class="w"> </span><span class="n">exam</span><span class="p">);</span>
</span><span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="hll"><span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">mark</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">homework</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">exam</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">homework</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exam</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
</span><span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="introducir-variable-explicativa">Introducir variable explicativa<a class="headerlink" href="#introducir-variable-explicativa" title="Permanent link">&para;</a></h2>
<p>Introducir variables para explicar una expresión compleja. Muy útil en condicionales.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>La condición es muy compleja y difícil de entender a simple vista.</li>
</ul>
<div class="highlight"><span class="filename">explainingvariable/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">salary</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">salary</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">applyDiscount</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">totalAmount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">66</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.2f</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="n">f</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">totalAmount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">totalAmount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.9f</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">totalAmount</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar la expresión a extraer y <code>Refactor &gt; Introduce Variable</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se extraen a variables cada una de las expresiones del condicional.</li>
</ul>
<div class="highlight"><span class="filename">explainingvariable/refactored/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">salary</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">salary</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">applyDiscount</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">totalAmount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isWorkingAge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">66</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isLowSalary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">salary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.2f</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="n">f</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isLittleAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalAmount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span>
<span class="hll"><span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isWorkingAge</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isLowSalary</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isLittleAmount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">totalAmount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.9f</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">totalAmount</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="separar-variable-temporal">Separar variable temporal<a class="headerlink" href="#separar-variable-temporal" title="Permanent link">&para;</a></h2>
<p>Utilizar variables específicas para cada propósito del método en lugar de una temporal que acumule todas las operaciones. Así, cada variable tendrá una responsabilidad única y evitamos posibles efectos inesperados.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>La variable <code>temp</code> se usa como cajón de sastre para todos los cálculos.</li>
</ul>
<div class="highlight"><span class="filename">splittemporaryvariable/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">totalPrice</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">vat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Applied vat: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total with vat: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crean variables específicas <code>appliedVat</code> y <code>priceWithVat</code> para cada operación.</li>
<li>Otro paso adidiconal sería extraer a un método específico la operación de cada variable.</li>
</ul>
<div class="highlight"><span class="filename">splittemporaryvariable/refactored/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">totalPrice</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">vat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">price</span><span class="p">;</span><span class="w">     </span>
</span><span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Applied vat: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">appliedVat</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="hll"><span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">priceWithVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">appliedVat</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">priceWithVat</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">priceWithVat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="eliminar-asignaciones-a-parametros">Eliminar asignaciones a parámetros<a class="headerlink" href="#eliminar-asignaciones-a-parametros" title="Permanent link">&para;</a></h2>
<p>Evitar que se asignen valores a un parámetro dentro de un método utilizando una variable local. Se evitan efectos inesperados y así cada parámetro tiene un propósito único.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Se modifica los valores de los parámetros <code>examMark</code> y <code>homeworkMark</code> dentro del método.</li>
</ul>
<p>``` java title="removeparameterassignment/Student.java" hl_lines=4 8"
public class Student {
    public float evaluateTerm(float homeworkMark, float examMark, float attitude) {
        if (examMark &lt; 5) {
            examMark = 1;
        }</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>    if (homeworkMark &lt; 4) {
<span class="linenos" data-linenos="2 "></span>        homeworkMark = 1;
<span class="linenos" data-linenos="3 "></span>    }
<span class="linenos" data-linenos="4 "></span>    return (homeworkMark + examMark) / 2 + attitude;
<span class="linenos" data-linenos="5 "></span>}
</code></pre></div>
<p>}
```</p>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea la variable local <code>finalMark</code> para no modificar los parámetros.</li>
</ul>
<div class="highlight"><span class="filename">removeparameterassignment/refactored/Student.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Student</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">evaluateTerm</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">homeworkMark</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">examMark</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">attitude</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">finalMark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">examMark</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">            </span><span class="n">finalMark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="n">finalMark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">examMark</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">homeworkMark</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">            </span><span class="n">finalMark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finalMark</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">finalMark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finalMark</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">homeworkMark</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">finalMark</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">attitude</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="reemplazar-metodo-con-un-objeto">Reemplazar método con un objeto<a class="headerlink" href="#reemplazar-metodo-con-un-objeto" title="Permanent link">&para;</a></h2>
<p>Extraer un método complejo o extenso a una clase aparte para simplificarlo.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El método <code>applyDiscount</code> es demasiado extenso y se extraerá a una clase.</li>
</ul>
<div class="highlight"><span class="filename">replacemethodwithmethodobject/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isVip</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isSpecial</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">NORMAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">SPECIAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">VIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">isVip</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isSpecial</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">isVip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isVip</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">isSpecial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isSpecial</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="hll"><span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">applyDiscount</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">finalPrice</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">appliedVat</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">getType</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">Customer</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">:</span>
<span class="linenos" data-linenos="23 "></span><span class="w">            </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.21f</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span><span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">Customer</span><span class="p">.</span><span class="na">SPECIAL</span><span class="p">:</span>
<span class="linenos" data-linenos="26 "></span><span class="w">            </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.15f</span><span class="p">;</span>
<span class="linenos" data-linenos="27 "></span><span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">Customer</span><span class="p">.</span><span class="na">VIP</span><span class="p">:</span>
<span class="linenos" data-linenos="29 "></span><span class="w">            </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.04f</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="k">default</span><span class="p">:</span>
<span class="linenos" data-linenos="32 "></span><span class="w">            </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.21f</span><span class="p">;</span>
<span class="linenos" data-linenos="33 "></span><span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isVip</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="37 "></span><span class="w">            </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="linenos" data-linenos="38 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isSpecial</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="39 "></span><span class="w">            </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos" data-linenos="40 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="41 "></span><span class="w">            </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="42 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="43 "></span>
<span class="linenos" data-linenos="44 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="45 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="46 "></span>
<span class="linenos" data-linenos="47 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getType</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="48 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos="49 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="50 "></span>
<span class="linenos" data-linenos="51 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isVip</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="52 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isVip</span><span class="p">;</span>
<span class="linenos" data-linenos="53 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="54 "></span>
<span class="linenos" data-linenos="55 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSpecial</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="56 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isSpecial</span><span class="p">;</span>
<span class="linenos" data-linenos="57 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="58 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se ha creado la clase <code>DiscountCalculator</code> con el método <code>applyDiscount</code>, el que a su vez, se ha extraido a métodos.</li>
<li>Mejora adicional: Sustituir el <code>switch</code> por una jerarquía de clases en la que la llamada al tipo de cliente se resuelva mediante polimorfismo.</li>
</ul>
<div class="highlight"><span class="filename">replacemethodwithmethodobject/refactored/DiscountCalculator.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DiscountCalculator</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">finalPrice</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">appliedVat</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">DiscountCalculator</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">appliedVat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">discount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span>
<span class="hll"><span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">applyDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">calculatePrice</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">calculateVat</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">calculateVat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">getType</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">Customer</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">:</span>
<span class="linenos" data-linenos="23 "></span><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">1.21f</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">Customer</span><span class="p">.</span><span class="na">SPECIAL</span><span class="p">:</span>
<span class="linenos" data-linenos="25 "></span><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">1.15f</span><span class="p">;</span>
<span class="linenos" data-linenos="26 "></span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">Customer</span><span class="p">.</span><span class="na">VIP</span><span class="p">:</span>
<span class="linenos" data-linenos="27 "></span><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">1.04f</span><span class="p">;</span>
<span class="linenos" data-linenos="28 "></span><span class="w">            </span><span class="k">default</span><span class="p">:</span>
<span class="linenos" data-linenos="29 "></span><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">1.21f</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">calculatePrice</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="na">isVip</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="35 "></span><span class="w">            </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="linenos" data-linenos="36 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="na">isSpecial</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="37 "></span><span class="w">            </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="linenos" data-linenos="38 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="39 "></span><span class="w">            </span><span class="n">finalPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="40 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="41 "></span>
<span class="linenos" data-linenos="42 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">finalPrice</span><span class="p">;</span>
<span class="linenos" data-linenos="43 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="44 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="descomponer-condicional">Descomponer condicional<a class="headerlink" href="#descomponer-condicional" title="Permanent link">&para;</a></h2>
<p>Sustituir expresiones complejas de un condicional por una llamada a un método. Así, se reducen los métodos y se crean condiciones reutilizables más expresivas. </p>
<p>Similar a la refactorización vista de <strong>Introducir variable explicativa</strong>, pero con un método.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<div class="highlight"><span class="filename">decomposeconditional/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="w"> </span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculatePayment</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">payment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="hll"><span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">payment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">discount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vat</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="n">payment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vat</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">payment</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar la expresión condicional y <code>Refactor &gt; Extract Method</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea el método <code>canApplyDiscount</code> para sustituir las expresiones complejas anteriores.</li>
</ul>
<div class="highlight"><span class="filename">decomposeconditional/refactored/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="w"> </span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculatePayment</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">payment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>
<span class="hll"><span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">canApplyDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">payment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">discount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vat</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">payment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vat</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">payment</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">canApplyDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">65</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="consolidar-expresion-condicional">Consolidar expresión condicional<a class="headerlink" href="#consolidar-expresion-condicional" title="Permanent link">&para;</a></h2>
<p>Agrupar los bloques condicionales que comparten el mismo código reduciendo el tamaño de los métodos y evitando código duplicado.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Varios bloques condicionales tienen exactamente el mismo código.</li>
</ul>
<div class="highlight"><span class="filename">consolidateconditional/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateTotal</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">GregorianCalendar</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="na">YEAR</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">year</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">subtotal</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vat</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>El código compartido se agrupa bajo una misma condición múltiple.</li>
<li>Se aplica además la refactorización anterior <strong>Descomponer condicional</strong> para extraer a un método dicho condicional.</li>
</ul>
<div class="highlight"><span class="filename">consolidateconditional/refactored/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateTotal</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isUselessToCharge</span><span class="p">(</span><span class="n">subtotal</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vat</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isUselessToCharge</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">().</span><span class="na">getYear</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">subtotal</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">);</span>
</span><span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="consolidar-fragmentos-de-condicional-duplicados">Consolidar fragmentos de condicional duplicados<a class="headerlink" href="#consolidar-fragmentos-de-condicional-duplicados" title="Permanent link">&para;</a></h2>
<p>Extraer código repetido en diferentes bloques de condicionales para evitar la duplicidad.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Algunas operaciones de los bloques del condicional son exactamente iguales y se podrían dejar fuera de los condicionales para que se apliquen en ambos casos.</li>
</ul>
<div class="highlight"><span class="filename">consolidateduplicateconditional/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">qty</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="w"> </span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">qty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qty</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateTotal</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">isVip</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">vat</span><span class="o">/</span><span class="mi">100</span><span class="p">));</span>
</span><span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qty</span><span class="p">);</span>
<span class="hll"><span class="linenos" data-linenos="21 "></span><span class="w">            </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">vat</span><span class="o">/</span><span class="mi">100</span><span class="p">));</span>
</span><span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>La operación duplicada se extrae fuera de los condiciones, aplicándola así en todos los casos.</li>
</ul>
<div class="highlight"><span class="filename">consolidateduplicateconditional/refactored/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">qty</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="w"> </span><span class="p">(</span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">qty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qty</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">calculateTotal</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">vat</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">isVip</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qty</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qty</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">vat</span><span class="o">/</span><span class="mi">100</span><span class="p">));</span>
</span><span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="eliminar-bandera-de-control">Eliminar bandera de control<a class="headerlink" href="#eliminar-bandera-de-control" title="Permanent link">&para;</a></h2>
<p>Eliminar variables que se utilizan para controlar el flujo del programa y en su lugar utilizar <em>break</em>, <em>continue</em> o <em>return</em> para conseguir el mismo propósito.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Existe una variable bandera <code>found</code> que sería interesante eliminar.</li>
</ul>
<div class="highlight"><span class="filename">removecontrolflag/Friends.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Friends</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">friends</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Friends</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">friends</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">friends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">friends</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">indexOf</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">friend</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="c1">// Bandera</span>
</span><span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">friends</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">found</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">friends</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">friend</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">                </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">found</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se podría sustituir la variable bandara con un <code>break</code> para salir del bucle, pero mucho mejor es hacerlo con el <code>return</code> devolviendo la posición directamente. </li>
</ul>
<div class="highlight"><span class="filename">packet/removecontrolflag/Friends.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Friends</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">friends</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Friends</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">friends</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">friends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">friends</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">indexOf</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">friend</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="w"> </span><span class="n">friends</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span>
<span class="linenos" data-linenos="10 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">friends</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">friend</span><span class="p">))</span><span class="w"> </span>
<span class="hll"><span class="linenos" data-linenos="11 "></span><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="reemplazar-condicionales-anidados-con-clausulas-guard">Reemplazar condicionales anidados con claúsulas guard<a class="headerlink" href="#reemplazar-condicionales-anidados-con-clausulas-guard" title="Permanent link">&para;</a></h2>
<p>Simplificar los condicionales anidados llegando idealmente a un único nivel para facilitar su legibilidad.</p>
<p>Una <strong>cláusula guard</strong> (también llamada "early return" o "return early") es una técnica de programación que permite evitar la anidación excesiva de estructuras condicionales (if-else) en el código. Sirve para hacer que el código sea más legible y fácil de entender, al "filtrar" las condiciones al principio de una función y retornar antes si alguna condición no se cumple.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Hay demasiados niveles if-else anidados que dificultan su comprensión.</li>
</ul>
<div class="highlight"><span class="filename">replacenestedconditionalguardclauses/Flight.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Flight</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">CHILDREN_DISCOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9f</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">UNEMPLOYED_DISCOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.8f</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Flight</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">distance</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">priceForPassenger</span><span class="w"> </span><span class="p">(</span><span class="n">Passenger</span><span class="w"> </span><span class="n">passenger</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passenger</span><span class="p">.</span><span class="na">isAChild</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getChildDiscount</span><span class="p">();</span>
</span><span class="hll"><span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passenger</span><span class="p">.</span><span class="na">isUnemployed</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="18 "></span><span class="w">                </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getUnemployedDiscount</span><span class="p">();</span>
</span><span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isChristmas</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="21 "></span><span class="w">                    </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="22 "></span><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="23 "></span><span class="w">                    </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getNormalPrice</span><span class="p">();</span>
</span><span class="hll"><span class="linenos" data-linenos="24 "></span><span class="w">                </span><span class="p">}</span>
</span><span class="hll"><span class="linenos" data-linenos="25 "></span><span class="w">            </span><span class="p">}</span>
</span><span class="hll"><span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="p">}</span>
</span><span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">getUnemployedDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">UNEMPLOYED_DISCOUNT</span><span class="p">;</span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="33 "></span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">getNormalPrice</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isChristmas</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="39 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos" data-linenos="40 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="41 "></span>
<span class="linenos" data-linenos="42 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">getChildDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="43 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CHILDREN_DISCOUNT</span><span class="p">;</span>
<span class="linenos" data-linenos="44 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="45 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se eliminan los if-else anidados dejándolos en un único nivel.</li>
</ul>
<div class="highlight"><span class="filename">replacenestedconditionalguardclauses/refactored/Flight.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Flight</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">CHILDREN_DISCOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9f</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">UNEMPLOYED_DISCOUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.8f</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Flight</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">distance</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">priceForPassenger</span><span class="w"> </span><span class="p">(</span><span class="n">Passenger</span><span class="w"> </span><span class="n">passenger</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passenger</span><span class="p">.</span><span class="na">isAChild</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">getChildDiscount</span><span class="p">();</span>
</span><span class="hll"><span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">passenger</span><span class="p">.</span><span class="na">isUnemployed</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">getUnemployedDiscount</span><span class="p">();</span>
</span><span class="hll"><span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isChristmas</span><span class="p">())</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getNormalPrice</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">getUnemployedDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">UNEMPLOYED_DISCOUNT</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">getNormalPrice</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">distance</span><span class="p">;</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isChristmas</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">getChildDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BASE_PRICE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">CHILDREN_DISCOUNT</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="reemplazar-condicional-con-polimorfismo">Reemplazar condicional con polimorfismo<a class="headerlink" href="#reemplazar-condicional-con-polimorfismo" title="Permanent link">&para;</a></h2>
<p>Sustituir las expresiones condicionales (normalmente un <code>switch</code>) por una jerarquía de clases en la que la llamada al tipo específico se resuelva mediante polimorfismo. </p>
<p>De esta forma se mejora el mantenimiento de la aplicación al ser más sencillo añadir nuevos casos en un futuro sin necesidad de duplicar código.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El <code>switch</code> se haría muy enrevesado si se tienen muchos tipos de vehículos.</li>
</ul>
<div class="highlight"><span class="filename">replaceconditionalwithpolymorphism/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">CAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">BIKE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">PLANE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Vehicle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">vehicleType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">acceleration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">move</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">vehicleType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">CAR</span><span class="p">:</span>
</span><span class="hll"><span class="linenos" data-linenos="21 "></span><span class="w">                </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">acceleration</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="22 "></span><span class="w">                </span><span class="k">break</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="23 "></span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">BIKE</span><span class="p">:</span>
</span><span class="hll"><span class="linenos" data-linenos="24 "></span><span class="w">                </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="25 "></span><span class="w">                </span><span class="k">break</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="26 "></span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">PLANE</span><span class="p">:</span>
</span><span class="hll"><span class="linenos" data-linenos="27 "></span><span class="w">                </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceleration</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="28 "></span><span class="w">                </span><span class="k">break</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="p">}</span>
</span><span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="33 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea una clase abstracta <code>Vehiculo</code> con su método abstracto <code>move</code>.</li>
<li>Se crean clases hijas <code>Bike</code>, <code>Car</code> y <code>Plane</code> que definen dicho método <code>move</code> al que se llamará directamente si necesidad del <code>switch</code>.</li>
</ul>
<div class="highlight"><span class="filename">replaceconditionalwithpolymorphism/refactored/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Vehicle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">vehicleType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">acceleration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="hll"><span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">move</span><span class="w"> </span><span class="p">();</span>
</span><span class="linenos" data-linenos="13 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">replaceconditionalwithpolymorphism/refactored/Bike.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Bike</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Bike</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="n">acceleration</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">move</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">replaceconditionalwithpolymorphism/refactored/Car.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Car</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Car</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="n">acceleration</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">move</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">acceleration</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">replaceconditionalwithpolymorphism/refactored/Plane.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Plane</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Plane</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="3 "></span><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">vehicleType</span><span class="p">,</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="n">acceleration</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">move</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w">  </span><span class="n">acceleration</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="introducir-objeto-nulo">Introducir objeto nulo<a class="headerlink" href="#introducir-objeto-nulo" title="Permanent link">&para;</a></h2>
<p>Utilizar un objeto que representa el valor <code>null</code> de algo evitando realizar comparaciones directamente con <code>null</code>, lo que no suele ser muy recomendable porque puede provocar errores inesperados.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Para el ataque del guerrero se comprueba que tenga un arma (no sea <code>null</code>) para obtener el daño que hace y sumarlo.</li>
</ul>
<div class="highlight"><span class="filename">introducenullobject/Weapon.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Weapon</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">damage</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Weapon</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">damage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">damage</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getDamage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">damage</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">introducenullobject/Warrior.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Warrior</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Weapon</span><span class="w"> </span><span class="n">weapon</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Warrior</span><span class="p">(</span><span class="n">Weapon</span><span class="w"> </span><span class="n">weapon</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">weapon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weapon</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">attack</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">weapon</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="11 "></span><span class="w">            </span><span class="n">damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">damage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">weapon</span><span class="p">.</span><span class="na">getDamage</span><span class="p">();</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">damage</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea la clase <code>NullWeapon</code> que hereda de <code>Weapon</code> y representa el daño que hace no tener un arma equipada, evitando así la comparacióin con <code>null</code> anterior.</li>
</ul>
<div class="highlight"><span class="filename">introducenullobject/refactored/Warrior.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">NullWeapon</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Weapon</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">NullWeapon</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">damage</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">damage</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getDamage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">introducenullobject/Warrior.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Warrior</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Weapon</span><span class="w"> </span><span class="n">weapon</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Warrior</span><span class="p">(</span><span class="n">Weapon</span><span class="w"> </span><span class="n">weapon</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">weapon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weapon</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">attack</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">weapon</span><span class="p">.</span><span class="na">getDamage</span><span class="p">();</span>
</span><span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="separar-consulta-de-modificacion">Separar consulta de modificación<a class="headerlink" href="#separar-consulta-de-modificacion" title="Permanent link">&para;</a></h2>
<p>Evitar que un mismo método haga una consulta de datos y relice modificaciones. Mejor separar en varios métodos para evitar que un método de consulta tenga resultados inesperados. Un método tiene que tener un único propósito.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El método <code>initVehicleAndGetType</code> modifica los atributos <code>horsePower</code> y <code>type</code>. Y además devuelve <code>type</code>. Un método sólo debería hacer una única tarea, en este caso o modificar, o bien obtener valores.</li>
</ul>
<div class="highlight"><span class="filename">separatequerymodify/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">horsePower</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Vehicle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">initVehicleAndGetType</span><span class="p">(</span><span class="n">power</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">initVehicleAndGetType</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">horsePower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">power</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="11 "></span>
</span><span class="hll"><span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">power</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Truck&quot;</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">power</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Car&quot;</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Bike&quot;</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="linenos" data-linenos="19 "></span>
</span><span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
</span><span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getHorsePower</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">horsePower</span><span class="p">;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getType</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="30 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se modifica el método de inicio <code>init</code> estableciendo en métodos separados los atributos.</li>
<li>Se hacen los getters correspondientes para obtener el valor de los atributos.</li>
</ul>
<div class="highlight"><span class="filename">separatequerymodify/refactored/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">horsePower</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Vehicle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">init</span><span class="p">(</span><span class="n">power</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">setPower</span><span class="p">(</span><span class="n">power</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="n">setType</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPower</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">power</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="n">horsePower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">power</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setType</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">horsePower</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Truck&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">horsePower</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">horsePower</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Car&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">            </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Bike&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getHorsePower</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">horsePower</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getType</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="parametrizar-metodo">Parametrizar método<a class="headerlink" href="#parametrizar-metodo" title="Permanent link">&para;</a></h2>
<p>Unificar en un método varios métodos en los que sólo cambia un valor para evitar código duplicado. Se hace, añadiendo al método un parámetro (el valor que cambia).</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Hay varios métodos que hacen lo mismo cambiando un único valor.</li>
</ul>
<div class="highlight"><span class="filename">parametrizemethod/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">,</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">charge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">chargeWithUnderageDiscount</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">payInCash</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">chargeWithCashDiscount</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">chargeNormal</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">chargeWithUnderageDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5f</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">total</span><span class="p">;</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span>
<span class="hll"><span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">chargeWithCashDiscount</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.8f</span><span class="p">;</span>
<span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">total</span><span class="p">;</span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="29 "></span>
<span class="hll"><span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">chargeNormal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="33 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se añade como parámetro del método el valor que cambia unificando todo en un único método.</li>
</ul>
<div class="highlight"><span class="filename">parametrizemethod/refactored/Invoice.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Invoice</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Invoice</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">subtotal</span><span class="p">,</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">subtotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subtotal</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">charge</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">getAge</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">charge</span><span class="p">(</span><span class="mf">0.5f</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">customer</span><span class="p">.</span><span class="na">payInCash</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">charge</span><span class="p">(</span><span class="mf">0.8f</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">charge</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="hll"><span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">charge</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">discount</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">subtotal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">discount</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="reemplazar-parametro-con-metodo-explicito">Reemplazar parámetro con método explícito<a class="headerlink" href="#reemplazar-parametro-con-metodo-explicito" title="Permanent link">&para;</a></h2>
<p>La contraria a la refactorización anterior. En este caso reemplazamos un parámetro por métodos específicos. Se suele utilizar en métodos que han crecido mucho o realizan varias acciones.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El método <code>initVehicle</code> ha crecido mucho con condicionales dentro para modificar varios atributos.</li>
</ul>
<div class="highlight"><span class="filename">replaceparameterwitexplicitmethod/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Vehicle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">acceleration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="hll"><span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initVehicle</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">acceleration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getAcceleration</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getSpeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="30 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>El método <code>initVehicle</code> se ha separado en los setters correspondientes a los atributos, simplificando así el código.</li>
</ul>
<div class="highlight"><span class="filename">replaceparameterwitexplicitmethod/refactored/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Vehicle</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">acceleration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getAcceleration</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getSpeed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>
<span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAcceleration</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">acceleration</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">acceleration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceleration</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="hll"><span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setSpeed</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="sustituir-algoritmo">Sustituir algoritmo<a class="headerlink" href="#sustituir-algoritmo" title="Permanent link">&para;</a></h2>
<p>Optimiza el código mejorando el rendimiento de un método que no sea eficiente y por ejemplo genere un cuello de botella.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>La variable <code>vatType</code> se comprueba con cada uno de los casos, lo que no es muy eficiente si se tiene que hacer para muchos datos.</li>
</ul>
<p>``` java title="susbtitutealtorithm/Order.java" hl_lines=""
public class Order {
    public float applyVAT (int vatType) {
        float result = 0;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>    switch (vatType) {
<span class="linenos" data-linenos=" 2 "></span>        case 1:
<span class="linenos" data-linenos=" 3 "></span>            result = 1.04f;
<span class="linenos" data-linenos=" 4 "></span>            break;
<span class="linenos" data-linenos=" 5 "></span>        case 2:
<span class="linenos" data-linenos=" 6 "></span>            result = 1.18f;
<span class="linenos" data-linenos=" 7 "></span>            break;
<span class="linenos" data-linenos=" 8 "></span>        case 3:
<span class="linenos" data-linenos=" 9 "></span>            result = 1.21f;
<span class="linenos" data-linenos="10 "></span>            break;
<span class="linenos" data-linenos="11 "></span>        default:
<span class="linenos" data-linenos="12 "></span>            result = -1;
<span class="linenos" data-linenos="13 "></span>            break;
<span class="linenos" data-linenos="14 "></span>}
<span class="linenos" data-linenos="15 "></span>return result;
<span class="linenos" data-linenos="16 "></span>}
</code></pre></div>
<p>}
```</p>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se ha sustituido cada caso del switch por una entrada del array, de tal forma que el valor de cada caso coincide con el índice del array. Así se puede devolver el valor que le corresponda de forma directa.</li>
</ul>
<div class="highlight"><span class="filename">susbtitutealtorithm/refactored/Order.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Order</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nf">applyVAT</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">vatType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">result</span><span class="o">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">1.04f</span><span class="p">,</span><span class="w"> </span><span class="mf">1.18f</span><span class="p">,</span><span class="w"> </span><span class="mf">1.21f</span><span class="p">};</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vatType</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">vatType</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="o">[</span><span class="n">vatType</span><span class="o">]</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="extraer-clase">Extraer clase<a class="headerlink" href="#extraer-clase" title="Permanent link">&para;</a></h2>
<p>Sacar parte del contenido de una clase a otra porque la clase original tenga demasiadas responsabilidades.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Los campos relacionados con la tarjeta de crédito se pueden extraer a otra clase.</li>
</ul>
<div class="highlight"><span class="filename">extractclass/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">dni</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">creditCard</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">creditCardDate</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">creditCardControlNumber</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">dni</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">dni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dni</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isCardExpired</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creditCardDate</span><span class="p">.</span><span class="na">before</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Date</span><span class="p">());</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isValid</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="c1">// Some code here...</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getDni</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dni</span><span class="p">;</span>
<span class="linenos" data-linenos="33 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="34 "></span>
<span class="linenos" data-linenos="35 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDni</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dni</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="36 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">dni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dni</span><span class="p">;</span>
<span class="linenos" data-linenos="37 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="38 "></span>
<span class="linenos" data-linenos="39 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getCreditCard</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="40 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creditCard</span><span class="p">;</span>
<span class="linenos" data-linenos="41 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="42 "></span>
<span class="linenos" data-linenos="43 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setCreditCard</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">creditCard</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="44 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">creditCard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creditCard</span><span class="p">;</span>
<span class="linenos" data-linenos="45 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="46 "></span>
<span class="linenos" data-linenos="47 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">getCreditCardDate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="48 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creditCardDate</span><span class="p">;</span>
<span class="linenos" data-linenos="49 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="50 "></span>
<span class="linenos" data-linenos="51 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setCreditCardDate</span><span class="p">(</span><span class="n">Date</span><span class="w"> </span><span class="n">creditCardDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="52 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">creditCardDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creditCardDate</span><span class="p">;</span>
<span class="linenos" data-linenos="53 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="54 "></span>
<span class="linenos" data-linenos="55 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getCreditCardControlNumber</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="56 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creditCardControlNumber</span><span class="p">;</span>
<span class="linenos" data-linenos="57 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="58 "></span>
<span class="linenos" data-linenos="59 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setCreditCardControlNumber</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">creditCardControlNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="60 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">creditCardControlNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creditCardControlNumber</span><span class="p">;</span>
<span class="linenos" data-linenos="61 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="62 "></span>
<span class="linenos" data-linenos="63 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea la clase <code>CreditCard</code> con sus atributos y métodos.</li>
</ul>
<p>``` java title="extractclass/refactored/Customer.java" hl_lines=""
public class Customer {
    private String name;
    private String dni;
    private CreditCard creditCard;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>public Customer(String name, String dni) {
<span class="linenos" data-linenos=" 2 "></span>    this.name = name;
<span class="linenos" data-linenos=" 3 "></span>    this.dni = dni;
<span class="linenos" data-linenos=" 4 "></span>}
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>public String getName() {
<span class="linenos" data-linenos=" 7 "></span>    return name;
<span class="linenos" data-linenos=" 8 "></span>}
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span>public void setName(String name) {
<span class="linenos" data-linenos="11 "></span>    this.name = name;
<span class="linenos" data-linenos="12 "></span>}
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span>public String getDni() {
<span class="linenos" data-linenos="15 "></span>    return dni;
<span class="linenos" data-linenos="16 "></span>}
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span>public void setDni(String dni) {
<span class="linenos" data-linenos="19 "></span>    this.dni = dni;
<span class="linenos" data-linenos="20 "></span>}
</code></pre></div>
<p>}
<code></code> java title="extractclass/refactored/CreditCard.java" hl_lines=""
public class CreditCard {
    private String creditCard;
    private Date creditCardDate;
    private int creditCardControlNumber;

    public CreditCard(String creditCard, Date creditCardDate, int creditCardControlNumber) {
        this.creditCard = creditCard;
        this.creditCardDate = creditCardDate;
        this.creditCardControlNumber = creditCardControlNumber;
    }

    public boolean isCardExpired () {
        return creditCardDate.before(new Date());
    }

    public boolean isValid () {
        boolean result = false;
        // Some code here...
        return result;
    }

    public Date getCreditCardDate() {
        return creditCardDate;
    }

    public void setCreditCardDate(Date creditCardDate) {
        this.creditCardDate = creditCardDate;
    }

    public int getCreditCardControlNumber() {
        return creditCardControlNumber;
    }

    public void setCreditCardControlNumber(int creditCardControlNumber) {
        this.creditCardControlNumber = creditCardControlNumber;
    }
}
```</p>
</details>
<h2 id="clase-en-linea">Clase en línea<a class="headerlink" href="#clase-en-linea" title="Permanent link">&para;</a></h2>
<p>Refactorización contraria a la anterior. Introducir los atributos y métodos de una clase que por sí sola no tenga mucho sentido en otra clase.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>La clase <code>Sex</code> sólo tiene un atributo y no define ningún comportamiento.</li>
</ul>
<p>``` java title="inlineclass/Person.java" hl_lines=""
public class Person {
    private String name;
    private Date birth;
    private Sex sex;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>public Person(String name, Date birth, int sexCode) {
<span class="linenos" data-linenos=" 2 "></span>    this.name = name;
<span class="linenos" data-linenos=" 3 "></span>    this.birth = birth;
<span class="linenos" data-linenos=" 4 "></span>    this.sex = new Sex(sexCode);
<span class="linenos" data-linenos=" 5 "></span>}
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>public String getName() {
<span class="linenos" data-linenos=" 8 "></span>    return name;
<span class="linenos" data-linenos=" 9 "></span>}
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>public void setName(String name) {
<span class="linenos" data-linenos="12 "></span>    this.name = name;
<span class="linenos" data-linenos="13 "></span>}
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>public Date getBirth() {
<span class="linenos" data-linenos="16 "></span>    return birth;
<span class="linenos" data-linenos="17 "></span>}
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span>public void setBirth(Date birth) {
<span class="linenos" data-linenos="20 "></span>    this.birth = birth;
<span class="linenos" data-linenos="21 "></span>}
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span>public Sex getSex() {
<span class="linenos" data-linenos="24 "></span>    return sex;
<span class="linenos" data-linenos="25 "></span>}
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span>public void setSex(Sex sex) {
<span class="linenos" data-linenos="28 "></span>    this.sex = sex;
<span class="linenos" data-linenos="29 "></span>}
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span>@Override
<span class="linenos" data-linenos="32 "></span>public String toString() {
<span class="linenos" data-linenos="33 "></span>    return &quot;Person [name=&quot; + name + &quot;, sex=&quot; + sex + &quot;]&quot;;
<span class="linenos" data-linenos="34 "></span>}
</code></pre></div>
<p>}
<code></code> java title="inlineclass/Person.java" hl_lines=""
public class Sex {
    public static final int MALE = 0;
    public static final int FEMALE = 1;
    private int sex;

    public Sex (int sex) {
        this.sex = sex;
    }

    public int getSex () {
        return sex;
    }

    @Override
    public String toString() {
        return Integer.toString(sex);
    }
}
```</p>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se introducen los atributos y métodos de <code>Sex</code> dentro de <code>Person</code>.</li>
</ul>
<p>``` java title="inlineclass/refactored/Person.java" hl_lines=""
public class Person {
    private String name;
    private Date birth;
    public static final int MALE = 0;
    public static final int FEMALE = 1;
    private int sex;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>public Person(String name, Date birth, int sexCode) {
<span class="linenos" data-linenos=" 2 "></span>    this.name = name;
<span class="linenos" data-linenos=" 3 "></span>    this.birth = birth;
<span class="linenos" data-linenos=" 4 "></span>    this.sex = sexCode;
<span class="linenos" data-linenos=" 5 "></span>}
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>public String getName() {
<span class="linenos" data-linenos=" 8 "></span>    return name;
<span class="linenos" data-linenos=" 9 "></span>}
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>public void setName(String name) {
<span class="linenos" data-linenos="12 "></span>    this.name = name;
<span class="linenos" data-linenos="13 "></span>}
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span>public Date getBirth() {
<span class="linenos" data-linenos="16 "></span>    return birth;
<span class="linenos" data-linenos="17 "></span>}
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span>public void setBirth(Date birth) {
<span class="linenos" data-linenos="20 "></span>    this.birth = birth;
<span class="linenos" data-linenos="21 "></span>}
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span>public int getSex() {
<span class="linenos" data-linenos="24 "></span>    return sex;
<span class="linenos" data-linenos="25 "></span>}
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span>public void setSex(int sex) {
<span class="linenos" data-linenos="28 "></span>    this.sex = sex;
<span class="linenos" data-linenos="29 "></span>}
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span>@Override
<span class="linenos" data-linenos="32 "></span>public String toString() {
<span class="linenos" data-linenos="33 "></span>    return &quot;Person [name=&quot; + name + &quot;, sex=&quot; + sex + &quot;]&quot;;
<span class="linenos" data-linenos="34 "></span>}
</code></pre></div>
<p>}
```</p>
</details>
<h2 id="ocultar-delegar">Ocultar Delegar<a class="headerlink" href="#ocultar-delegar" title="Permanent link">&para;</a></h2>
<p>Evitar que un cliente (método principal por ejemplo) pueda acceder a una clase delegada a través de clases intermedias.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Desde la clase <code>Main</code> se accede al dado <code>Die</code> que depende de <code>Player</code>.</li>
</ul>
<div class="highlight"><span class="filename">hidedelegate/Main.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Player</span><span class="w"> </span><span class="n">player</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Die</span><span class="w"> </span><span class="n">die</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Main</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">init</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">player</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Player</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="n">die</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="na">getDie</span><span class="p">();</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="13 "></span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">roll</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">die</span><span class="p">.</span><span class="na">roll</span><span class="p">();</span>
</span><span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
<p>``` java title="hidedelegate/Player.java" hl_lines=""
public class Player {
    private Die die;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>public Player () {
<span class="linenos" data-linenos=" 2 "></span>    this.die = new Die();
<span class="linenos" data-linenos=" 3 "></span>}
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>public int roll () {
<span class="linenos" data-linenos=" 6 "></span>    return die.roll();
<span class="linenos" data-linenos=" 7 "></span>}
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>public Die getDie() {
<span class="linenos" data-linenos="10 "></span>    return die;
<span class="linenos" data-linenos="11 "></span>}
</code></pre></div>
<p>}
<code></code> java title="hidedelegate/Die.java" hl_lines=""
public class Die {
    private Random random = new Random();

    public int roll() {
        return random.nextInt(6) + 1;
    }
}
```</p>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>La clase <code>Main</code> ya no tiene la dependencia de <code>Die</code>, que sólo está en <code>Player</code>.</li>
</ul>
<div class="highlight"><span class="filename">hidedelegate/refactored/Main.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Main</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Player</span><span class="w"> </span><span class="n">player</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Main</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="n">init</span><span class="p">();</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="n">player</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Player</span><span class="p">();</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">roll</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">player</span><span class="p">.</span><span class="na">roll</span><span class="p">();</span>
</span><span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<p>``` java title="hidedelegate/refactored/Player.java" hl_lines=""
public class Player {
    private Die die;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public Player () {
<span class="linenos" data-linenos="2 "></span>    this.die = new Die();
<span class="linenos" data-linenos="3 "></span>}
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span>public int roll() {
<span class="linenos" data-linenos="6 "></span>    return die.roll();
<span class="linenos" data-linenos="7 "></span>}
</code></pre></div>
<p>}
<code></code> java title="hidedelegate/refactored/Die.java" hl_lines=""
public class Die {
    private Random random = new Random();

    public int roll() {
        return random.nextInt(6) + 1;
    }
}
```</p>
</details>
<h2 id="introducir-metodo-externo">Introducir método externo<a class="headerlink" href="#introducir-metodo-externo" title="Permanent link">&para;</a></h2>
<p>Añadir un método en la clase cliente para extender la funcionalidad de otra clase a la que no tenemos acceso.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El método <code>improvePassword</code> completa un String de asteriscos si este es muy corto.</li>
</ul>
<p><code>java title="introduceforeignmethod/PasswordChecker.java" hl_lines=""
public class PasswordChecker {
    public String improvePassword (String password) {
        if (password.length() &lt; 5) {
            return "****" + password + "****";
        } else {
            return password;
        }
    }
}</code></p>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Extendemos la funcionalidad de la clase <code>String</code> completando con el propio password dado la vuelta si este es muy corto.</li>
</ul>
<p>``` java title="introduceforeignmethod/refactored/PasswordChecker.java" hl_lines=""
public class PasswordChecker {
    public String improvePassword (String password) {
        if (password.length() &lt; 5) {
            return makeItPalindrome(password);
        } else {
            return password;
        }
    }</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>// We extend String functionality
<span class="linenos" data-linenos="2 "></span>private static String makeItPalindrome (String password) {
<span class="linenos" data-linenos="3 "></span>    return new String(password + new StringBuilder(password)
<span class="linenos" data-linenos="4 "></span>                                                    .reverse()
<span class="linenos" data-linenos="5 "></span>                                                    .toString());
<span class="linenos" data-linenos="6 "></span>}
</code></pre></div>
<p>}
```</p>
</details>
<h2 id="introducir-extension-local">Introducir extensión local<a class="headerlink" href="#introducir-extension-local" title="Permanent link">&para;</a></h2>
<p>Extender una clase para darle una nueva funcionalidad.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Suponemos que no tenemos acceso a <code>Conversor</code> para añadir nuevos métodos.</li>
</ul>
<p>``` java title="introducelocalextension/Main.java" hl_lines=""
public class Main {
    private Conversor conversor = new Conversor();</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public double convert (double amount) {
<span class="linenos" data-linenos="2 "></span>    return conversor.euro2Dollar(amount);
<span class="linenos" data-linenos="3 "></span>}
</code></pre></div>
<p>}
<code></code> java title="introducelocalextension/Conversor.java" hl_lines=""
public class Conversor {
    public double euro2Dollar (double qty) {
        return qty * 1.4d;
    }

    public double dollar2Euro (double qty) {
        return qty * 0.6d;
    }
}
```</p>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Rename</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Creamos una subclase <code>CoolConversor</code> de <code>Conversor</code> con sus funciones y añadimos las nuevas que necesitemos.</li>
</ul>
<p>``` java title="introducelocalextension/refactored/Main.java" hl_lines=""
public class Main {
    private CoolConversor conversor = new CoolConversor();</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public double convert (double amount) {
<span class="linenos" data-linenos="2 "></span>    return conversor.euro2Dollar(amount);
<span class="linenos" data-linenos="3 "></span>}
</code></pre></div>
<p>}
<code></code> java title="introducelocalextension/refactored/CoolConversor.java" hl_lines=""
public class CoolConversor extends Conversor {
    public double euro2Pound (double qty) {
        return qty * 0.8d;
    }

    public double pound2Euro (double qty) {
        return qty * 1.3d;
    }
}
```</p>
<p>``` java title="introducelocalextension/refactored/Conversor.java" hl_lines=""
public class Conversor {
    public double euro2Dollar (double qty) {
        return qty * 1.4d;
    }</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public double dollar2Euro (double qty) {
<span class="linenos" data-linenos="2 "></span>    return qty * 0.6d;
<span class="linenos" data-linenos="3 "></span>}
</code></pre></div>
<p>}
```</p>
</details>
<h2 id="reemplazar-un-dato-con-un-objeto">Reemplazar un dato con un objeto<a class="headerlink" href="#reemplazar-un-dato-con-un-objeto" title="Permanent link">&para;</a></h2>
<p>Reemplazar un atributo de una clase por un objeto porque necesite que le dotemos de algún comportamiento más amplio.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>Campo <code>address</code> se queda corto en este caso porque necesitamos diferenciar la ciudad, código postal...</li>
</ul>
<div class="highlight"><span class="filename">replacedatawithobject/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEmail</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setEmail</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getAddress</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAddress</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="37 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="38 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Customer [name=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, email=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, address=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="39 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="40 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se extrae <code>address</code> a un objeto para poder diferenciar las partes de la propia dirección.</li>
</ul>
<div class="highlight"><span class="filename">replacedatawithobject/refactored/Customer.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEmail</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setEmail</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="p">;</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Address</span><span class="w"> </span><span class="nf">getAddress</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAddress</span><span class="p">(</span><span class="n">Address</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="37 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="38 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Customer [name=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, email=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, address=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="39 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="40 "></span><span class="p">}</span>
</code></pre></div>
<p>``` java title="replacedatawithobject/refactored/Address.java" hl_lines=""
public class Address {
    private String street;
    private String po;
    private String city;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>public Address(String street, String po, String city) {
<span class="linenos" data-linenos=" 2 "></span>    this.street = street;
<span class="linenos" data-linenos=" 3 "></span>    this.po = po;
<span class="linenos" data-linenos=" 4 "></span>    this.city = city;
<span class="linenos" data-linenos=" 5 "></span>}
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>@Override
<span class="linenos" data-linenos=" 8 "></span>public String toString() {
<span class="linenos" data-linenos=" 9 "></span>    return city;
<span class="linenos" data-linenos="10 "></span>}
</code></pre></div>
<p>}
```</p>
</details>
<h2 id="encapsular-coleccion">Encapsular colección<a class="headerlink" href="#encapsular-coleccion" title="Permanent link">&para;</a></h2>
<p>ES común que al añadir los <em>getters</em> de forma automática, se añada un get de una colección que no deberíamos devolver. Esta refactorización consiste en encapsular esa colección, ocultandándola para que esté disponible sólo a través de los métodos que nos interese.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El método <code>getPlayers</code> devuelve la colección completa de jugadores y no debería ser así.</li>
</ul>
<div class="highlight"><span class="filename">encapsultacollection/Team.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Team</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">creation</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Team</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">creation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">creation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creation</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">getCreation</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creation</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>
<span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getPlayers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">players</span><span class="p">;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">totalPlayers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">players</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crean métodos <code>getPlayer</code>, <code>addPlayer</code> y <code>removePlayer</code> para gestionar la colección sin necesidad de devolverla.</li>
</ul>
<div class="highlight"><span class="filename">encapsultacollection/refactored/Team.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Team</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">creation</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Team</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">creation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">creation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creation</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">getCreation</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">creation</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>
<span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Player</span><span class="w"> </span><span class="nf">getPlayer</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">players</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="hll"><span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addPlayer</span><span class="w"> </span><span class="p">(</span><span class="n">Player</span><span class="w"> </span><span class="n">player</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="n">players</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">player</span><span class="p">);</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="hll"><span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">removePlayer</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="n">players</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">totalPlayers</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">players</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
<span class="linenos" data-linenos="33 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="34 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="pull-up">Pull up<a class="headerlink" href="#pull-up" title="Permanent link">&para;</a></h2>
<p>Subir atributos y métodos comunes entre clases hijas, a la superclase.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El atributo <code>plate</code> (matrícula) y el método <code>start</code> están repetidos en las clases hijas.</li>
</ul>
<p>``` java title="pullup/Vehicle.java" hl_lines=""
public class Vehicle {
    protected String name;
}
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>``` java title=&quot;pullup/Car.java&quot; hl_lines=&quot;2 6&quot;
<span class="linenos" data-linenos=" 2 "></span>public class Car extends Vehicle {
<span class="linenos" data-linenos=" 3 "></span>    private String plate;
<span class="linenos" data-linenos=" 4 "></span>    private String trunk;
<span class="linenos" data-linenos=" 5 "></span>    private boolean isTrunkOpened;
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>    public void start() { ... }
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span>    public boolean isTrunkOpen() {
<span class="linenos" data-linenos="10 "></span>        return isTrunkOpened;
<span class="linenos" data-linenos="11 "></span>    }
<span class="linenos" data-linenos="12 "></span>}
</code></pre></div></p>
<div class="highlight"><span class="filename">pullup/MotorBike.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MotorBike</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">plate</span><span class="p">;</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">helmet</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="hll"><span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Pull Members Up</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se sube a la clase padre el atributo común <code>plate</code> y método común <code>start</code>.</li>
</ul>
<div class="highlight"><span class="filename">pullup/refactored/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">plate</span><span class="p">;</span>
</span><span class="linenos" data-linenos="4 "></span>
<span class="hll"><span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span>
</span><span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">pullup/refactored/Car.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Car</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">trunk</span><span class="p">;</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isTrunkOpened</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isTrunkOpen</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="6 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isTrunkOpened</span><span class="p">;</span>
</span><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="8 "></span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><span class="filename">pullup/refactored/MotorBike.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MotorBike</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">helmet</span><span class="p">;</span>
</span><span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
</details>
<h2 id="push-down">Push down<a class="headerlink" href="#push-down" title="Permanent link">&para;</a></h2>
<p>La refactorización contraria a la anterior. Ocurre cuando hay atributos o métodos de una superclase que no tienen sentido en todas las clases hijas. En ese caso, se mueven a las clases hijas que correspondan.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>En una clase hija <code>Bicycle</code> no tiene sentido los atributos de matrícula, seguro, ni el método arrancar.</li>
</ul>
<div class="highlight"><span class="filename">pushdown/Vehicle.java</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Vehicle</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">plate</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">Insurance</span><span class="w"> </span><span class="n">insurance</span><span class="p">;</span>
</span><span class="linenos" data-linenos="5 "></span>
<span class="hll"><span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w">  </span><span class="p">}</span>
</span><span class="linenos" data-linenos="7 "></span><span class="p">}</span>
</code></pre></div>
</details>
<p>En IntelliJ IDEA, seleccionar el método/variable y <code>Refactor &gt; Push Members Down</code>.</p>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Los atributos y métodos se pasan a las clase que los utilicen.</li>
</ul>
<p>``` java title="pushdown/refactored/Vehicle.java" hl_lines=""
public class Vehicle {
    protected String name;
}
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>``` java title=&quot;pushdown/refactored/Car.java&quot; hl_lines=&quot;4 5 11&quot;
<span class="linenos" data-linenos=" 2 "></span>public class Car extends Vehicle {
<span class="linenos" data-linenos=" 3 "></span>    private String trunk;
<span class="linenos" data-linenos=" 4 "></span>    private boolean isTrunkOpened;
<span class="linenos" data-linenos=" 5 "></span>    protected String plate;
<span class="linenos" data-linenos=" 6 "></span>    protected Insurance insurance;
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    public boolean isTrunkOpen() {
<span class="linenos" data-linenos=" 9 "></span>        return isTrunkOpened;
<span class="linenos" data-linenos="10 "></span>    }
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    public void start() { ... }
<span class="linenos" data-linenos="13 "></span>}
</code></pre></div></p>
<p><code>java title="pushdown/refactored/Bicycle.java" hl_lines=""
public class Bicycle extends Vehicle {
    private String helmet;
}</code></p>
</details>
<h2 id="reemplazar-array-con-objeto">Reemplazar array con objeto<a class="headerlink" href="#reemplazar-array-con-objeto" title="Permanent link">&para;</a></h2>
<p>Cuando tenemos un array simplemente para almacenar una serie de datos variados, se puede reemplazar por un objeto con dichos datos para hacer el código más legible.</p>
<details class="warning" open="open">
<summary>Código mejorable...</summary>
<ul>
<li>El array <code>pilotData</code> se usa para almacenar datos variados sobre el piloto.</li>
</ul>
<div class="highlight"><span class="filename">replacearraywithobject/Airplane.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Airplane</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">pilotData</span><span class="o">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Airplane</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initPilot</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">license</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flightHours</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">pilotData</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="n">pilotData</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">license</span><span class="p">;</span>
</span><span class="hll"><span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="n">pilotData</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">flightHours</span><span class="p">);</span>
</span><span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Airplane [model=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, pilot=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pilotData</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="p">}</span>
</code></pre></div>
</details>
<details class="abstract">
<summary>Refactorización</summary>
<ul>
<li>Se crea una clase <code>Pilot</code> cuyos atributos son los datos que se almacenaban en el array. </li>
</ul>
<div class="highlight"><span class="filename">replacearraywithobject/refactored/Airplane.java</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Airplane</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Pilot</span><span class="w"> </span><span class="n">pilot</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Airplane</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initPilot</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">license</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flightHours</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">pilot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Pilot</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">license</span><span class="p">,</span><span class="w"> </span><span class="n">flightHours</span><span class="p">);</span>
</span><span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Airplane [model=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, pilot=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pilot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
<p>``` java title="replacearraywithobject/refactored/Pilot.java" hl_lines=""
public class Pilot {
    private String name;
    private String license;
    private int flightHours;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public Pilot (String name, String license, int flightHours) {
<span class="linenos" data-linenos="2 "></span>    this.name = name;
<span class="linenos" data-linenos="3 "></span>    this.license = license;
<span class="linenos" data-linenos="4 "></span>    this.flightHours = flightHours;
<span class="linenos" data-linenos="5 "></span>}
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span>public String toString() {
<span class="linenos" data-linenos="8 "></span>    return name;
<span class="linenos" data-linenos="9 "></span>}
</code></pre></div>
<p>}
```</p>
</details>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2025 Eladio Blanco - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/eladioblanco" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.2 4.2 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84q-.51 0-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<eladio.blanco@fernando3martos.com>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.56.56 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "toc.integrate", "content.code.copy", "content.code.select", "content.tabs.link"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>